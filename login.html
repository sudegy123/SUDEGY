<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
  <meta charset="utf-8" />
  <title>SudEgy — تسجيل الدخول</title>

  <!-- Tailwind -->
  <script src="https://cdn.tailwindcss.com"></script>

  <!-- Firebase compat -->
  <script src="https://www.gstatic.com/firebasejs/9.24.0/firebase-app-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/9.24.0/firebase-auth-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/9.24.0/firebase-firestore-compat.js"></script>

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <style>
    @import url('https://fonts.googleapis.com/css2?family=Inter:wght@300;400;600;700&display=swap');
    :root {
      --brand: #ff6a00;
      --navy: #0b2a56;
      --muted: #6b7280;
    }
    body { font-family: Inter, system-ui, -apple-system, "Segoe UI", Roboto, "Helvetica Neue", Arial; background: linear-gradient(135deg,#0b2a56 0%, #142a4a 40%, #0b2a56 100%); min-height:100vh; }
    .glass { background: linear-gradient(180deg, rgba(255,255,255,0.06), rgba(255,255,255,0.02)); backdrop-filter: blur(6px); border: 1px solid rgba(255,255,255,0.06); }
    .brand-accent { background: linear-gradient(90deg, var(--brand), #ff914d); }
  </style>
</head>

<body class="antialiased text-gray-100">

  <div class="min-h-screen flex items-center justify-center px-6 py-12">
    <div class="max-w-4xl w-full grid grid-cols-1 md:grid-cols-2 gap-8 items-center">

      <!-- LEFT: Hero / Brand -->
      <div class="hidden md:flex flex-col gap-6 justify-center pl-8">
        <div class="flex items-center gap-3">
          <div class="w-12 h-12 rounded-lg brand-accent flex items-center justify-center shadow-lg">
            <!-- logo placeholder -->
            <svg width="22" height="22" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
              <path d="M4 12h16" stroke="#fff" stroke-width="1.6" stroke-linecap="round" stroke-linejoin="round"/>
              <path d="M12 4v16" stroke="#fff" stroke-width="1.6" stroke-linecap="round" stroke-linejoin="round"/>
            </svg>
          </div>
          <div>
            <h1 class="text-2xl font-bold text-white">SudEgy</h1>
            <p class="text-sm text-white/80">ربط الأعمال بين مصر والسودان — المنصة الاحترافية للمشاريع والصناعات</p>
          </div>
        </div>

        <div class="glass p-6 rounded-2xl shadow-xl">
          <h3 class="text-white font-semibold text-lg mb-2">لماذا SudEgy؟</h3>
          <ul class="text-sm text-white/80 space-y-2">
            <li>• دليل خبراء وموردين موثوقين</li>
            <li>• رسائل فورية وآمنة بين المسجلين</li>
            <li>• إدارة منتجات، عقود، وطلبات بسهولة</li>
          </ul>
        </div>

        <div class="text-white/70 text-sm">
          <p class="mb-2">مساعدة سريعة</p>
          <p class="text-xs">لو تواجه أي مشكلة في تسجيل الدخول تواصل معنا عبر support@sudegy.com</p>
        </div>
      </div>

      <!-- RIGHT: Login card -->
      <div class="mx-auto w-full max-w-md">
        <div class="glass p-8 rounded-3xl shadow-2xl">
          <div class="flex items-center justify-between mb-6">
            <div>
              <h2 class="text-2xl font-bold text-white">تسجيل الدخول</h2>
              <p class="mt-1 text-sm text-white/75">سجل دخولك لحسابك لتواصل مع الخبراء وبدء المحادثات</p>
            </div>
            <div class="hidden sm:flex items-center gap-2">
              <span class="text-xs text-white/70">جديد هنا؟</span>
              <a href="register.html" class="px-3 py-1 rounded-md bg-white text-sm text-amber-600 font-semibold shadow">أنشئ حساب</a>
            </div>
          </div>

          <!-- form -->
          <form id="loginForm" class="space-y-4">
            <div>
              <label class="text-sm text-white/80">البريد الإلكتروني</label>
              <input id="login-email" type="email" autocomplete="email" required
                class="mt-2 w-full rounded-xl px-4 py-3 bg-white/6 border border-white/6 placeholder-white/40 text-white focus:outline-none focus:ring-2 focus:ring-amber-400" placeholder="example@domain.com">
            </div>

            <div>
              <div class="flex items-center justify-between">
                <label class="text-sm text-white/80">كلمة المرور</label>
                <a href="#" id="forgot" class="text-xs text-white/70 hover:underline">نسيت كلمة المرور؟</a>
              </div>
              <div class="relative mt-2">
                <input id="login-password" type="password" autocomplete="current-password" required
                  class="w-full rounded-xl px-4 py-3 bg-white/6 border border-white/6 placeholder-white/40 text-white focus:outline-none focus:ring-2 focus:ring-amber-400" placeholder="••••••••">
                <button type="button" id="togglePwd" aria-label="Toggle password"
                  class="absolute inset-y-0 left-3 flex items-center text-white/60 px-2">
                  <svg id="showEye" xmlns="http://www.w3.org/2000/svg" class="h-5 w-5" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="1.6" d="M15 12a3 3 0 11-6 0 3 3 0 016 0z" />
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="1.6" d="M2.458 12C3.732 7.943 7.523 5 12 5c4.477 0 8.268 2.943 9.542 7-1.274 4.057-5.065 7-9.542 7-4.477 0-8.268-2.943-9.542-7z" />
                  </svg>
                </button>
              </div>
            </div>

            <div id="errorBox" class="hidden text-sm text-red-400 bg-red-900/30 p-3 rounded-lg"></div>

            <div class="pt-2">
              <button id="submitBtn" type="submit" class="w-full rounded-xl py-3 font-semibold text-white brand-accent shadow-lg flex items-center justify-center gap-3">
                <svg class="h-5 w-5 opacity-90" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M12 5v14M5 12h14" stroke="white" stroke-width="1.6" stroke-linecap="round" stroke-linejoin="round"/></svg>
                <span id="btnText">تسجيل دخول</span>
                <svg id="btnSpinner" class="hidden animate-spin h-5 w-5" viewBox="0 0 24 24"><circle cx="12" cy="12" r="10" stroke="white" stroke-width="3" stroke-linecap="round" stroke-dasharray="60" stroke-dashoffset="0" fill="none"></circle></svg>
              </button>
            </div>

            <div class="pt-3 text-center text-xs text-white/60">
              بتقدر تسجل دخول بـ <strong>البريد وكلمة المرور</strong> أو تستخدم واجهة تسجيلنا.
            </div>
          </form>

          <div class="mt-6 border-t border-white/6 pt-4 text-center text-white/80 text-sm">
            <span>للمساعدة اتصل: </span><a href="mailto:support@sudegy.com" class="text-amber-200 hover:underline">support@sudegy.com</a>
          </div>
        </div>
      </div>

    </div>
  </div>

  <!-- Firebase init (احتفظ بتهيئتك الحالية) -->
  <script>
    const firebaseConfig = {
      apiKey: "AIzaSyBvnFMuXY_d5PKrKV-4Vp_fYyKD2c428Yw",
      authDomain: "sudegy-4c4e5.firebaseapp.com",
      projectId: "sudegy-4c4e5",
      storageBucket: "sudegy-4c4e5.appspot.com",
      messagingSenderId: "865758231874",
      appId: "1:865758231874:web:d1959356198ca1f809dcdb"
    };
    // initialize once
    if (!firebase.apps.length) {
      firebase.initializeApp(firebaseConfig);
    }
    const auth = firebase.auth();
    const db = firebase.firestore();
  </script>

  <!-- Page logic -->
  <script>
    // UI elements
    const loginForm = document.getElementById('loginForm');
    const submitBtn = document.getElementById('submitBtn');
    const btnText = document.getElementById('btnText');
    const btnSpinner = document.getElementById('btnSpinner');
    const errorBox = document.getElementById('errorBox');
    const togglePwd = document.getElementById('togglePwd');
    const pwdInput = document.getElementById('login-password');
    const forgotLink = document.getElementById('forgot');

    // Toggle password visibility
    togglePwd.addEventListener('click', () => {
      if (pwdInput.type === 'password') {
        pwdInput.type = 'text';
      } else {
        pwdInput.type = 'password';
      }
    });

    function showError(msg) {
      errorBox.innerText = msg;
      errorBox.classList.remove('hidden');
    }
    function clearError() {
      errorBox.innerText = '';
      errorBox.classList.add('hidden');
    }

    loginForm.addEventListener('submit', async (e) => {
      e.preventDefault();
      clearError();
      const email = document.getElementById('login-email').value.trim();
      const password = pwdInput.value;
      if (!email || !password) { showError('الرجاء إدخال البريد والكلمة'); return; }

      // UI loading
      btnText.classList.add('opacity-0');
      btnSpinner.classList.remove('hidden');

      try {
        await auth.signInWithEmailAndPassword(email, password);
        // redirect to home
        window.location.href = 'index.html';
      } catch (err) {
        showError(err.message || 'فشل تسجيل الدخول');
      } finally {
        btnText.classList.remove('opacity-0');
        btnSpinner.classList.add('hidden');
      }
    });

    // Forgot password flow
    forgotLink.addEventListener('click', async (ev) => {
      ev.preventDefault();
      clearError();
      const email = prompt('أدخل بريدك لاستلام رابط إعادة تعيين كلمة المرور:');
      if (!email) return;
      try {
        await auth.sendPasswordResetEmail(email);
        alert('أرسلنا رابط إعادة التعيين إلى: ' + email);
      } catch (err) {
        showError(err.message || 'حدث خطأ أثناء الإرسال');
      }
    });

    // Optional: listen auth state (redirect if already logged in)
    auth.onAuthStateChanged(user => {
      if (user) {
        // لو تريده يعيد توجيه تلقائيًا عند وجود جلسة
        // window.location.href = 'index.html';
      }
    });
  </script>

</body>
</html>
